(this.webpackJsonppages=this.webpackJsonppages||[]).push([[192],{106:function(e,t,n){"use strict";function a(e){if(Array.isArray(e))return e}n.d(t,"a",(function(){return a}))},107:function(e,t,n){"use strict";function a(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.d(t,"a",(function(){return a}))},133:function(e,t,n){"use strict";var a=n(11),o=n(12),r=n(62),s=n(79),i=n(7),l=function(){function e(){Object(a.a)(this,e)}return Object(o.a)(e,null,[{key:"fetchGET",value:function(e,t,n){return fetch(this.ADDRESS+"/open/"+e,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"GET"}).then((function(e){return e.json()})).then((function(e){t(e)}),(function(e){n(e)})),!0}},{key:"fetchPOST",value:function(e,t,n,a){return fetch(r.a.ADDRESS+"/open/"+e,{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){n(e)}),(function(e){a(e)})),!0}},{key:"getRanking",value:function(t,n,a,o){e.fetchPOST("get_ranking",{rank:t,count:n},a,(function(e){i.c.error("Failed to load ranking results.",{autoClose:1e4}),null!=o&&o(e)}))}},{key:"getBrawl",value:function(t,n,a,o,r){e.postWithToastPayload("get_brawl",n,{attackerUsername:t,attackerProjectName:n,defenderUsername:a,defenderProjectName:o},"Loading ","Failed to load "," loaded.",r)}},{key:"getProgress",value:function(t,n,a){e.postWithToastPayload("get_progress",n,{username:t,projectName:n},"Loading ","Failed to load "," loaded.",a)}},{key:"post",value:function(t,n,a){e.fetchPOST(t,{name:n},(function(e){a&&a(e)}),(function(e){console.log("POST ERROR: "+t),console.log(e),void 0!==e&&null!==e&&e.toString().length<100&&i.c.error(e.toString(),{autoClose:1e4})}))}},{key:"get",value:function(t,n){e.fetchGET(t,(function(e){n&&n(e)}),(function(e){console.log("GET ERROR: "+t),console.log(e),void 0!==e&&null!==e&&e.toString().length<100&&i.c.error(e.toString(),{autoClose:1e4})}))}},{key:"postWithToast",value:function(t,n,a,o,r,l){var c=i.c.warning(a+n+"...",{autoClose:!1});e.fetchPOST(t,{name:n},(function(e){s.a.finishToast(e,c,o,r,n,l(e))}),(function(e){s.a.finishToast(e,c,o,r,n,void 0)}))}},{key:"postWithToastPayload",value:function(t,n,a,o,r,l,c){var u=i.c.warning(o+n+"...",{autoClose:!1});e.fetchPOST(t,a,(function(e){s.a.finishToast(e,u,r,l,n,c(e))}),(function(e){s.a.finishToast(e,u,r,l,n,void 0)}))}}]),e}();t.a=l},251:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(252);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){Object(a.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}},252:function(e,t,n){"use strict";function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",(function(){return a}))},54:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(14),o=n(6),r=n.n(o),s=n(0),i=n.n(s);function l(e){return(l="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function d(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function h(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function p(e){return t=e,(t-=0)===t?e:(e=e.replace(/[\-_\s]+(.)?/g,(function(e,t){return t?t.toUpperCase():""}))).substr(0,1).toLowerCase()+e.substr(1);var t}function j(e){return e.split(";").map((function(e){return e.trim()})).filter((function(e){return e})).reduce((function(e,t){var n,a=t.indexOf(":"),o=p(t.slice(0,a)),r=t.slice(a+1).trim();return o.startsWith("webkit")?e[(n=o,n.charAt(0).toUpperCase()+n.slice(1))]=r:e[o]=r,e}),{})}var m=!1;try{m=!0}catch(y){}function v(e){return null===e?null:"object"===l(e)&&e.prefix&&e.iconName?e:Array.isArray(e)&&2===e.length?{prefix:e[0],iconName:e[1]}:"string"===typeof e?{prefix:"fas",iconName:e}:void 0}function g(e,t){return Array.isArray(t)&&t.length>0||!Array.isArray(t)&&t?c({},e,t):{}}function b(e){var t=e.forwardedRef,n=d(e,["forwardedRef"]),o=n.icon,r=n.mask,s=n.symbol,i=n.className,l=n.title,u=v(o),p=g("classes",[].concat(h(function(e){var t,n=e.spin,a=e.pulse,o=e.fixedWidth,r=e.inverse,s=e.border,i=e.listItem,l=e.flip,u=e.size,f=e.rotation,d=e.pull,h=(c(t={"fa-spin":n,"fa-pulse":a,"fa-fw":o,"fa-inverse":r,"fa-border":s,"fa-li":i,"fa-flip-horizontal":"horizontal"===l||"both"===l,"fa-flip-vertical":"vertical"===l||"both"===l},"fa-".concat(u),"undefined"!==typeof u&&null!==u),c(t,"fa-rotate-".concat(f),"undefined"!==typeof f&&null!==f&&0!==f),c(t,"fa-pull-".concat(d),"undefined"!==typeof d&&null!==d),c(t,"fa-swap-opacity",e.swapOpacity),t);return Object.keys(h).map((function(e){return h[e]?e:null})).filter((function(e){return e}))}(n)),h(i.split(" ")))),j=g("transform","string"===typeof n.transform?a.c.transform(n.transform):n.transform),y=g("mask",v(r)),x=Object(a.a)(u,f({},p,{},j,{},y,{symbol:s,title:l}));if(!x)return function(){var e;!m&&console&&"function"===typeof console.error&&(e=console).error.apply(e,arguments)}("Could not find icon",u),null;var S=x.abstract,k={ref:t};return Object.keys(n).forEach((function(e){b.defaultProps.hasOwnProperty(e)||(k[e]=n[e])})),O(S[0],k)}b.displayName="FontAwesomeIcon",b.propTypes={border:r.a.bool,className:r.a.string,mask:r.a.oneOfType([r.a.object,r.a.array,r.a.string]),fixedWidth:r.a.bool,inverse:r.a.bool,flip:r.a.oneOf(["horizontal","vertical","both"]),icon:r.a.oneOfType([r.a.object,r.a.array,r.a.string]),listItem:r.a.bool,pull:r.a.oneOf(["right","left"]),pulse:r.a.bool,rotation:r.a.oneOf([0,90,180,270]),size:r.a.oneOf(["lg","xs","sm","1x","2x","3x","4x","5x","6x","7x","8x","9x","10x"]),spin:r.a.bool,symbol:r.a.oneOfType([r.a.bool,r.a.string]),title:r.a.string,transform:r.a.oneOfType([r.a.string,r.a.object]),swapOpacity:r.a.bool},b.defaultProps={border:!1,className:"",mask:null,fixedWidth:!1,inverse:!1,flip:null,icon:null,listItem:!1,pull:null,pulse:!1,rotation:null,size:null,spin:!1,symbol:!1,title:"",transform:null,swapOpacity:!1};var O=function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("string"===typeof n)return n;var o=(n.children||[]).map((function(n){return e(t,n)})),r=Object.keys(n.attributes||{}).reduce((function(e,t){var a=n.attributes[t];switch(t){case"class":e.attrs.className=a,delete n.attributes.class;break;case"style":e.attrs.style=j(a);break;default:0===t.indexOf("aria-")||0===t.indexOf("data-")?e.attrs[t.toLowerCase()]=a:e.attrs[p(t)]=a}return e}),{attrs:{}}),s=a.style,i=void 0===s?{}:s,l=d(a,["style"]);return r.attrs.style=f({},r.attrs.style,{},i),t.apply(void 0,[n.tag,f({},r.attrs,{},l)].concat(h(o)))}.bind(null,i.a.createElement)},62:function(e,t,n){"use strict";var a=n(11),o=n(12),r=function(){function e(){Object(a.a)(this,e)}return Object(o.a)(e,null,[{key:"loginUrl",value:function(e,t){fetch(this.ADDRESS+"/login/").then((function(e){return e.json()})).then((function(t){e(t)}),(function(e){t(e)}))}},{key:"authorize",value:function(e,t,n){var a=this;return fetch(this.ADDRESS+"/login/authorize",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({code:e})}).then((function(e){return e.json()})).then((function(e){a.parseJWT(e),t()}),(function(e){n(e)})),!0}},{key:"authenticate",value:function(e,t,n,a){var o=this;return fetch(this.ADDRESS+"/login/authenticate",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({username:e,password:t})}).then((function(e){return e.json()})).then((function(e){o.parseJWT(e),n(e)}),(function(e){a(e)})),!0}},{key:"register",value:function(e,t,n,a,o,r){var s=JSON.stringify({username:e,password:t,email:n,agree:a});return(null===n||void 0===n||n.length<1)&&(s=JSON.stringify({username:e,password:t,agree:a})),fetch(this.ADDRESS+"/login/register",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:s}).then((function(e){return e.json()})).then((function(e){o(e)}),(function(e){r(e)})),!0}},{key:"updateLoginButton",value:function(){e.loginButton&&e.loginButton.updateLoginState()}},{key:"refresh",value:function(t,n){var a=this,o=localStorage.getItem(this.REFRESH_TOKEN);return void 0===o?(n("Not logged in."),!1):(fetch(this.ADDRESS+"/login/refresh",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({token:o})}).then((function(e){return e.json()})).then((function(o){void 0!==o.success?o.success?a.parseJWT(o)?t():n("Didn't undertand the response from the server."):(e.logout(),void 0!==o.reason?n(o.reason):n("Unsuccessful refresh of access token.")):n("Unknown error on refreshing access token.")}),(function(e){n(e)})),!0)}},{key:"fetchSecureGET",value:function(e,t,n){var a=this,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=sessionStorage.getItem(this.ACCESS_TOKEN);return void 0===r||this.isAccessTokenExpired()?o?(this.refresh((function(){a.fetchSecureGET(e,t,n,o=!1)}),n),!0):(n("Not logged in."),!1):(fetch(this.ADDRESS+"/secure/"+e,{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+r},method:"GET"}).then((function(e){return e.json()})).then((function(e){t(e)}),(function(r){o?a.refresh((function(){a.fetchSecureGET(e,t,n,o=!1)}),n):n(r)})),!0)}},{key:"fetchSecurePOST",value:function(e,t,n,a){var o=this,r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=sessionStorage.getItem(this.ACCESS_TOKEN);return void 0===s?r?(this.refresh((function(){o.fetchSecurePOST(e,n,a,r=!1)}),a),!0):(a("Not logged in."),!1):(fetch(this.ADDRESS+"/secure/"+e,{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+s},method:"POST",body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){n(e)}),(function(s){r?o.refresh((function(){o.fetchSecurePOST(e,t,n,a,r=!1)}),a):a(s)})),!0)}},{key:"getUsername",value:function(){return localStorage.getItem(this.USERNAME)}},{key:"logout",value:function(){sessionStorage.removeItem(this.ACCESS_TOKEN),sessionStorage.removeItem(this.ACCESS_TOKEN_EXPIRY),localStorage.removeItem(this.REFRESH_TOKEN),localStorage.removeItem(this.REFRESH_TOKEN_EXPIRY),localStorage.removeItem(this.USERNAME),this.updateLoginButton()}},{key:"isLoggedIn",value:function(){var t=void 0!==this.getUsername()&&null!==this.getUsername();return t&&e.isRefreshTokenExpired()&&(e.logout(),t=!1),t}},{key:"parseJWT",value:function(e){if(void 0===e.access_token)return this.logout(),!1;sessionStorage.setItem(this.ACCESS_TOKEN,e.access_token),localStorage.setItem(this.REFRESH_TOKEN,e.refresh_token);var t=e.access_token.split(".");if(null!==t&&3===t.length){var n=atob(t[1]);n=JSON.parse(n),sessionStorage.setItem(this.ACCESS_TOKEN_EXPIRY,n.exp)}localStorage.setItem(this.USERNAME,e.username);var a=JSON.parse(atob(e.refresh_token.split(".")[1]));return localStorage.setItem(this.REFRESH_TOKEN_EXPIRY,a.exp),this.updateLoginButton(),!0}},{key:"isAccessTokenExpired",value:function(){var e=sessionStorage.getItem(this.ACCESS_TOKEN_EXPIRY);return void 0===e||null===e||new Date(1e3*parseInt(e))-new Date<0}},{key:"isRefreshTokenExpired",value:function(){var e=localStorage.getItem(this.REFRESH_TOKEN_EXPIRY);return void 0===e||null===e||new Date(1e3*parseInt(e))-new Date<0}},{key:"ACCESS_TOKEN",get:function(){return"access_token"}},{key:"ACCESS_TOKEN_EXPIRY",get:function(){return"access_token_expiry"}},{key:"REFRESH_TOKEN",get:function(){return"refresh_token"}},{key:"REFRESH_TOKEN_EXPIRY",get:function(){return"refresh_token_expiry"}},{key:"USERNAME",get:function(){return"username"}},{key:"ADDRESS",get:function(){return"https://api.brawl.ai"}}]),e}();r.loginButton=null,t.a=r},63:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(70);function o(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=Object(a.a)(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,i=!0,l=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){l=!0,s=e},f:function(){try{i||null==n.return||n.return()}finally{if(l)throw s}}}}},70:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(77);function o(e,t){if(e){if("string"===typeof e)return Object(a.a)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(a.a)(e,t):void 0}}},720:function(e,t,n){"use strict";n.r(t);var a=n(251),o=n(95),r=n(63),s=n(1),i=n(0),l=n(62),c=n(79),u=n(54);function f(e){var t=e.text;return 1===e.project?Object(s.jsx)("span",{className:"results-attacker-colour",children:t}):Object(s.jsx)("span",{className:"results-defender-colour",children:t})}function d(e){var t=e.text;return Object(s.jsx)("span",{className:"results-dimmed-colour",children:t})}function h(e){var t=e.units,n=e.project,a=e.time,o=[];null!=t&&null!=t.length||console.log("WARNING: unit does not have length or is null! "+a);for(var r=0;r<t.length;r++)r>0&&r<t.length-1?o.push(Object(s.jsx)("span",{children:", "},t[r].unit+"-"+n+"-"+a+"-colon-span-"+r)):r>0&&r===t.length-1&&o.push(Object(s.jsx)("span",{children:" and "},t[r].unit+"-"+n+"-"+a+"-and-span-"+r)),o.push(Object(s.jsx)(f,{text:t[r].unit,project:n},t[r].unit+"-"+n+"-"+a+"- "+r));return o}function p(e,t){var n,a=[],o=Object(r.a)(e);try{for(o.s();!(n=o.n()).done;){var s=n.value;s!==t&&a.push(s)}}catch(i){o.e(i)}finally{o.f()}return a}function j(e,t){var n=e.events[e.events.length-1];e.events.push(Object.assign({},n,t))}function m(e,t,n,a,o,i,l){var c=null,u=e.project;if(t.project===e.project)if(t.unit===n.name)c=n;else{var d,p=Object(r.a)(a.units);try{for(p.s();!(d=p.n()).done;){var m=d.value;m.name===t.unit&&(c=m)}}catch(x){p.e(x)}finally{p.f()}}else if(t.project!==e.project){u=1===e.project?2:1;var v,g=Object(r.a)(o.units);try{for(g.s();!(v=g.n()).done;){var b=v.value;b.name===t.unit&&(c=b)}}catch(x){g.e(x)}finally{g.f()}}if(null==c&&console.log("WARNING: Could not find the visible unit "+t.unit+" from project "+u+"!"),null!=c){var O="new"===t.reason||"visible"===t.reason;if(j(c,{time:i,visible:O,health:t.health,armorBonus:t.armorBonus,enemyName:t.unitEnemyName}),O){var y=1;1===u&&(y=2),l.push({text:Object(s.jsxs)("span",{children:[Object(s.jsx)(f,{text:c.name,project:u})," is now visible to ",Object(s.jsx)(h,{units:t.seenBy,project:y,time:i}),""]}),time:i})}else l.push({text:Object(s.jsxs)("span",{children:[Object(s.jsx)(f,{text:c.name,project:u})," is now invisible to the enemy."]}),time:i})}}function v(e,t,n,a,i,l,c,u,d){var h=t,p=n;2===e.project&&(h=n,p=t);var v,O=null,y=Object(r.a)(h.units);try{for(y.s();!(v=y.n()).done;){var x=v.value;if(x.name===e.unit){O=x;break}}}catch(oe){y.e(oe)}finally{y.f()}if(null===O)return console.log("WARNING: could not find unit in move: '"+e.project+"':'"+e.unit+"'"),c;var S=O.events[O.events.length-1],k=e.path[e.path.length-1];d.push({text:Object(s.jsxs)("span",{children:[Object(s.jsx)(f,{text:O.name,project:e.project})," moves from ["+S.location.x+", "+S.location.z+"] to ["+k[0]+", "+k[1]+"]"]}),time:c});for(var N=[],T=e.path,w=0;w<T.length;w++){if(w>0){var E=T[w-1],R=T[w],P=150;E[0]!==R[0]&&E[1]!==R[1]&&(P*=1.4),c+=P}var A=0;if(0!==a[T[w][1]][T[w][0]]){var C=i[T[w][1]][T[w][0]];(-1===C||C>=c)&&(A=1),-1!==C&&C<c&&(A=.1)}j(O,{time:c,location:{x:T[w][0],y:A,z:T[w][1]},dashing:e.actionsUsed>=2,moving:!0});for(var D=0;D<u.length;D++){var _=u[D],I=null;if(_.project===e.project&&_.unit===O.name)I=_.location;else if(_.project!==e.project&&null!=_.seenBy){var z,W=Object(r.a)(_.seenBy);try{for(W.s();!(z=W.n()).done;){var F=z.value;F.unit===O.name&&(I=F.location)}}catch(oe){W.e(oe)}finally{W.f()}}if(null!=I&&I[0]===T[w][0]&&I[1]===T[w][1])for(;D>0;)m(e,_=u[0],O,h,p,c,d),u.splice(0,1),D--}var B=!1;if(l.length>0){var L,M=T[w][0],U=T[w][1],G=Object(r.a)(l);try{for(G.s();!(L=G.n()).done;){var J=L.value;if(null!=J.target&&M===J.target[0]&&U===J.target[0]){var K=b(J,t,n,a,c,d),Y=Object(o.a)(K,2),H=Y[0],X=Y[1];c=H,N=N.concat(X),B=!0}else if(null!=J.targets){var q,V=Object(r.a)(J.targets);try{for(V.s();!(q=V.n()).done;){var $=q.value;if(M===$.location[0]&&U===$.location[1]){var Q=b(J,t,n,a,c,d),Z=Object(o.a)(Q,2),ee=Z[0],te=Z[1];c=ee,N=N.concat(te),B=!0}}}catch(oe){V.e(oe)}finally{V.f()}}}}catch(oe){G.e(oe)}finally{G.f()}}if(B){var ne=!1;if(O.events.length>0){var ae=O.events[O.events.length-1];if(void 0!==ae.dead&&ae.dead){console.log("WARNING: Unit "+e.unit+" should be dead!"),ne=!0;break}}ne||j(O,{time:c,location:{x:T[w][0],y:A,z:T[w][1]}})}}return j(O,{time:c,actions:e.actionsLeft,dashing:!1,moving:!1}),g(u,t,n,c,d),[c,N]}function g(e,t,n,a,o){if(e.length>0)for(var i=e.length-1;i>=0;i--){var l=e[i],c=t;2===l.project&&(c=n);var u,d=null,p=Object(r.a)(c.units);try{for(p.s();!(u=p.n()).done;){var m=u.value;m.name===l.unit&&(d=m)}}catch(b){p.e(b)}finally{p.f()}if(null==d&&console.log("WARNING: Could not find the visible unit!"),null!=d){var v="new"===l.reason||"visible"===l.reason;if(j(d,{time:a,visible:v,health:l.health,armorBonus:l.armorBonus,enemyName:l.unitEnemyName}),v){var g=1;1===l.project&&(g=2),o.push({text:Object(s.jsxs)("span",{children:[Object(s.jsx)(f,{text:d.name,project:l.project})," is now visible to ",Object(s.jsx)(h,{units:l.seenBy,project:g,time:a}),""]}),time:a})}else o.push({text:Object(s.jsxs)("span",{children:[Object(s.jsx)(f,{text:d.name,project:l.project})," is now invisible to the enemy."]}),time:a})}e.splice(i,1)}}function b(e,t,n,a,o,i){var l=t;2===e.project&&(l=n);var c,u=null,h=Object(r.a)(l.units);try{for(h.s();!(c=h.n()).done;){var p=c.value;if(p.name===e.unit){u=p;break}}}catch(J){h.e(J)}finally{h.f()}var m=[];if(null!=e.targets){var v,g=Object(r.a)(e.targets);try{for(g.s();!(v=g.n()).done;){var b=v.value,O=t;2===b.project&&(O=n);var y,x=Object(r.a)(O.units);try{for(x.s();!(y=x.n()).done;){var S=y.value;if(S.name===b.unit){b.u=S,m.push(b);break}}}catch(J){x.e(J)}finally{x.f()}}}catch(J){g.e(J)}finally{g.f()}}if(null===u)return console.log("WARNING: could not find unit in hit: '"+e.project+"':'"+e.unit+"'"),o;var k=!1,N={x:-1,z:-1};null!=u.events&&u.events.length>0?N=u.events[u.events.length-1].location:(N.x=u.location[0],N.z=u.location[1]);var T=150;N.x===e.location[0]&&N.z===e.location[1]||(k=!0,j(u,{time:o,location:{x:N.x,y:0,z:N.z},peeking:!0}),j(u,{time:o+=300,location:{x:e.location[0],y:0,z:e.location[1]}}));var w=[],E=[0,0];null!=e.path&&e.path.length>0&&(E=e.path[e.path.length-1]),m.length>0&&(E=m[m.length-1].location);var R=E[0]-e.location[0],P=E[1]-e.location[1],A=20*Math.sqrt(R*R+P*P);A<250&&(A=250);var C="";null!=e.overwatch&&e.overwatch&&(C=" from overwatch"),i.push({text:Object(s.jsxs)("span",{children:[Object(s.jsx)(f,{text:u.name,project:e.project})," shoots"+C," with "+e.item," from ["+e.location[0]+", "+e.location[1]+"] towards ["+E[0]+", "+E[1]+"]"]}),time:o}),w.push({time:o,duration:A,source:{x:e.location[0],z:e.location[1]},target:{x:E[0],z:E[1]}});var D=u.events[u.events.length-1],_=1;"rifle"===e.item?_=2:"pistol"===e.item&&(_=1),j(u,{time:o,ammo:D.ammo-1,actions:D.actions-_,shooting:!0}),o+=A;var I=!1,z=!1,W=!1;if(m.length>0){var F,B=Object(r.a)(m);try{for(B.s();!(F=B.n()).done;){var L=F.value;if(!L.hit){i.push({text:Object(s.jsxs)("span",{children:[Object(s.jsx)(f,{text:u.name,project:e.project})," missed ",Object(s.jsx)(f,{text:L.u.name,project:L.project}),Object(s.jsx)(d,{text:" (hit: "+L.hitRoll+" / "+L.hitChance+")"})]}),time:o});break}L.crit?i.push({text:Object(s.jsxs)("span",{children:[Object(s.jsx)(f,{text:u.name,project:e.project})," critically hits ",Object(s.jsx)(f,{text:L.u.name,project:L.project})," dealing "+L.damage+" damage",Object(s.jsx)(d,{text:" (hit: "+L.hitRoll+" / "+L.hitChance+",  crit: "+L.critRoll+" / "+L.critChance+",  distance: "+L.distance+",  defence: "+L.defense+")"})]}),time:o}):i.push({text:Object(s.jsxs)("span",{children:[Object(s.jsx)(f,{text:u.name,project:e.project})," hits ",Object(s.jsx)(f,{text:L.u.name,project:L.project})," dealing "+L.damage+" damage",Object(s.jsx)(d,{text:" (hit: "+L.hitRoll+" / "+L.hitChance+",  crit: "+L.critRoll+" / "+L.critChance+",  distance: "+L.distance+",  defence: "+L.defense+")"})]}),time:o});var M=L.u.events[L.u.events.length-1];if(!M.dead){var U=o,G=!1;null!=M&&(M.location.x===L.location[0]&&M.location.y===L.location[1]||(G=!0,U-=T,j(L.u,{time:U,peeking:!0}),U+=T)),j(L.u,{time:U,location:{x:L.location[0],y:0,z:L.location[1]},hit:!0,health:L.health,damaged:!0}),U+=1e3,I=!0,j(L.u,{time:U,location:{x:L.location[0],y:0,z:L.location[1]},hit:!1,damaged:!1}),L.health<=0?(i.push({text:Object(s.jsxs)("span",{children:[Object(s.jsx)(f,{text:L.u.name,project:L.project})," is incapacitated."]}),time:o}),j(L.u,{time:U,location:{x:L.location[0],y:0,z:L.location[1]},dead:!0}),U+=100,z=!0):G&&(U+=T,j(L.u,{time:U,location:{x:M.location.x,y:0,z:M.location.z},peeking:!1}),W=!0)}}}catch(J){B.e(J)}finally{B.f()}}return I&&(o+=1e3),z&&(o+=100),W&&(o+=T),k&&(j(u,{time:o,location:{x:e.location[0],y:0,z:e.location[1]}}),o+=T),j(u,{time:o,location:{x:N.x,y:0,z:N.z},peeking:!1,shooting:!1}),[o,w]}function O(e,t,n,a,i,l,c){var u=t;2===e.project&&(u=n);var d,h=null,m=Object(r.a)(u.units);try{for(m.s();!(d=m.n()).done;){var v=d.value;if(v.name===e.unit){h=v;break}}}catch(U){m.e(U)}finally{m.f()}if(null===h)return console.log("WARNING: could not find unit in item: '"+e.project+"':'"+e.unit+"'"),i;var b=null;null!=h.events&&h.events.length>0?b=h.events[h.events.length-1].location:(b.x=h.location[0],b.z=h.location[1]);var O=e.target,y=O[0]-b.x,x=O[1]-b.z,S=100*Math.sqrt(y*y+x*x);S<250&&(S=250);var k={time:i,duration:S,source:{x:b.x,z:b.z},target:{x:O[0],z:O[1]}};c.push({text:Object(s.jsxs)("span",{children:[Object(s.jsx)(f,{text:h.name,project:e.project})," throws grenade from ","["+b.x+", "+b.z+"] to ["+O[0]+", "+O[1]+"]"]}),time:i});var N=h.events[h.events.length-1];j(h,{time:i+50,items:p(N.items,"grenade"),actions:N.actions-2,throwing:!0}),i+=S;var T=!1,w=!1;if(a.length>0){var E,R=Object(r.a)(a);try{for(R.s();!(E=R.n()).done;){var P=E.value,A=t;2===P.targetProject&&(A=n);var C,D=Object(r.a)(A.units);try{for(D.s();!(C=D.n()).done;){var _=C.value;if(_.name===P.target){P.u=_;break}}}catch(U){D.e(U)}finally{D.f()}if(null!=P.u){var I=P.u.events[P.u.events.length-1];if(!I.dead){var z=i,W=Object(o.a)(P.u.location,2),F=W[0],B=W[1],L=0;null!=I&&(F=I.location.x,L=I.location.y,B=I.location.z),c.push({text:Object(s.jsxs)("span",{children:[Object(s.jsx)(f,{text:h.name,project:e.project})," damages ",Object(s.jsx)(f,{text:P.u.name,project:P.targetProject})," with a grenade dealing "+P.damage+" damage"]}),time:i}),j(P.u,{time:z,location:{x:F,y:L,z:B},hit:!0,health:P.health,armorBonus:P.armorBonus,damaged:!0}),z+=1e3,T=!0,j(P.u,{time:z,location:{x:F,y:L,z:B},hit:!1,damaged:!1}),P.health<=0&&(c.push({text:Object(s.jsxs)("span",{children:[Object(s.jsx)(f,{text:P.u.name,project:P.targetProject})," is incapacitated."]}),time:i}),j(P.u,{time:z,location:{x:F,y:L,z:B},dead:!0}),z+=100,w=!0)}}else console.log("WARNING: could not target find unit in item: '"+e.project+"':'"+P.unit+"'")}}catch(U){R.e(U)}finally{R.f()}}var M=i+100;return j(h,{time:i+=500,throwing:!1}),g(l,t,n,i+500,c),T&&(i+=1e3),w&&(i+=100),[i,k,M]}function y(e,t,n,a,i,l){var c=t;2===e.project&&(c=n);var u,d=null,h=Object(r.a)(c.units);try{for(h.s();!(u=h.n()).done;){var m=u.value;if(m.name===e.unit){d=m;break}}}catch(W){h.e(W)}finally{h.f()}if(null===d)return console.log("WARNING: could not find unit in item: '"+e.project+"':'"+e.unit+"'"),i;var v=null;null!=d.events&&d.events.length>0?v=d.events[d.events.length-1].location:(v.x=d.location[0],v.z=d.location[1]);var g=e.target,b={time:i,duration:500,source:{x:v.x,z:v.z},target:{x:g[0],z:g[1]}};l.push({text:Object(s.jsxs)("span",{children:[Object(s.jsx)(f,{text:d.name,project:e.project})," uses medikit from ","["+v.x+", "+v.z+"] to ["+g[0]+", "+g[1]+"]"]}),time:i});var O=d.events[d.events.length-1];j(d,{time:i+50,items:p(O.items,"medikit"),actions:O.actions-2,throwing:!0}),i+=500;var y=!1;if(a.length>0){var x,S=Object(r.a)(a);try{for(S.s();!(x=S.n()).done;){var k=x.value,N=t;2===k.targetProject&&(N=n);var T,w=Object(r.a)(N.units);try{for(w.s();!(T=w.n()).done;){var E=T.value;if(E.name===k.target){k.u=E;break}}}catch(W){w.e(W)}finally{w.f()}if(null!=k.u){var R=k.u.events[k.u.events.length-1];if(!R.dead){var P=i,A=Object(o.a)(k.u.location,2),C=A[0],D=A[1],_=0;null!=R&&(C=R.location.x,_=R.location.y,D=R.location.z);var I=-1*k.damage;I>0?l.push({text:Object(s.jsxs)("span",{children:[Object(s.jsx)(f,{text:d.name,project:e.project})," heals ",Object(s.jsx)(f,{text:k.u.name,project:k.targetProject})," with a medikit restoring "+I+" damage"]}),time:i}):console.log("WARNING: expected a heal, but got damage instead!"),j(k.u,{time:P,location:{x:C,y:_,z:D},hit:!0,health:k.health,armorBonus:k.armorBonus,healing:!0}),P+=1e3,y=!0,j(k.u,{time:P,location:{x:C,y:_,z:D},hit:!1,healing:!1})}}else console.log("WARNING: could not target find unit in item: '"+e.project+"':'"+k.unit+"'")}}catch(W){S.e(W)}finally{S.f()}}var z=i+100;return j(d,{time:i+=500,throwing:!1}),y&&(i+=1e3),[i,b,z]}function x(e,t,n,a,o){var i=t;2===e.project&&(i=n);var l,c=null,u=Object(r.a)(i.units);try{for(u.s();!(l=u.n()).done;){var d=l.value;if(d.name===e.unit){c=d;break}}}catch(v){u.e(v)}finally{u.f()}if(null===c)return console.log("WARNING: could not find unit in item: '"+e.project+"':'"+e.unit+"'"),a;var h=null;null!=c.events&&c.events.length>0?h=c.events[c.events.length-1].location:(h.x=c.location[0],h.z=c.location[1]);var p={time:a,duration:500,source:{x:h.x,z:h.z},target:{x:h.x,z:h.z}},m=c.events[c.events.length-1];return j(c,{time:a,weaponMags:m.weaponMags-1,reloading:!0,actions:m.actions-2}),j(c,{time:(a+=500)+250,ammo:c.maxAmmo,reloading:!1}),o.push({text:Object(s.jsxs)("span",{children:[Object(s.jsx)(f,{text:c.name,project:e.project})," reloads"]}),time:a+250}),[a+=500,p]}function S(e,t,n,a,s,i,l){0!==e.height&&console.log("WARNING: obstacleUpdate height is not 0");var c,u=Object(r.a)(e.locations);try{for(u.s();!(c=u.n()).done;){var f=c.value,d=Object(o.a)(f,2),h=d[0],p=d[1];-1!==t[p][h]&&console.log("WARNING: overwriting obstacle destruction!"),t[p][h]=n}}catch(b){u.e(b)}finally{u.f()}for(var j="",m=0;m<e.locations.length;m++){m>0&&m<e.locations.length-1?j+=", ":m>0&&m===e.locations.length-1&&(j+=" and ");var v=e.locations[m];j+="["+v[0]+", "+v[1]+"]"}return l.push({text:"Obstacles destroyed at "+j,time:n}),g(i,a,s,n+=100,l),n}function k(e){e.events=[{time:0,location:{x:e.location[0],y:0,z:e.location[1]},visible:!1,dead:!1,health:e.health,ammo:e.ammo,armorBonus:e.armorBonus,weaponMags:e.weaponMags,items:e.items,overwatch:!1,hit:!1,actions:2,dashing:!1,moving:!1,shooting:!1,reloading:!1,healing:!1,throwing:!1,peeking:!1,damaged:!1,enemyName:null}]}function N(e,t,n,a,i,l){a+=100;var c=e;2===n&&(c=t);var u,d=Object(r.a)(c.units);try{for(d.s();!(u=d.n()).done;){j(u.value,{time:a,actions:2,overwatch:!1})}}catch(E){d.e(E)}finally{d.f()}var h=!1;if(i.length>0){var p,m=Object(r.a)(i);try{for(m.s();!(p=m.n()).done;){var v=p.value,g=e;2===v.targetProject&&(g=t);var b,O=Object(r.a)(g.units);try{for(O.s();!(b=O.n()).done;){var y=b.value;if(y.name===v.target){v.u=y;break}}}catch(E){O.e(E)}finally{O.f()}if(null!=v.u){var x=v.u.events[v.u.events.length-1];if(!x.dead){var S=a,k=Object(o.a)(v.u.location,2),N=k[0],T=k[1];if(null!=x&&(N=x.location.x,T=x.location.z),v.damage){var w="";"medikit"===v.item&&(w=" (too much health)"),l.push({text:Object(s.jsxs)("span",{children:[Object(s.jsx)(f,{text:v.u.name,project:v.targetProject})," receives "+v.damage," damage from "+v.item+w]}),time:a})}else console.log("WARNING: expected damage, but got heal instead!");j(v.u,{time:S,location:{x:N,y:0,z:T},hit:!0,health:v.health,armorBonus:v.armorBonus,damaged:!0}),S+=1e3,h=!0,j(v.u,{time:S,location:{x:N,y:0,z:T},hit:!1,damaged:!1})}}else console.log("WARNING: could not target find unit in new turn: '"+n+"':'"+v.unit+"'")}}catch(E){m.e(E)}finally{m.f()}}return h&&(a+=1e3),a}var T=function(e,t,n){var a=JSON.parse(e[0]),i=JSON.parse(e[1]);if(2===a.project){var l=a;a=i,i=l}var c=[],u=[],h=[],p=[];if("setup"!==a.action||"setup"!==i.action)return[null,null,[],[],0];var m=function(e){for(var t=[],n=0;n<e.length;n++){t.push([]);for(var a=0;a<e[n].length;a++)t[n].push(-1)}return t}(t);!function(e,t){var n,a=Object(r.a)(e.units);try{for(a.s();!(n=a.n()).done;){var o=n.value;k(o),o.project=e.project}}catch(c){a.e(c)}finally{a.f()}var s,i=Object(r.a)(t.units);try{for(i.s();!(s=i.n()).done;){var l=s.value;k(l),l.project=t.project}}catch(c){i.e(c)}finally{i.f()}}(a,i);for(var g=0,T=[],w=[],E=[],R=[],P=[],A=0,C=0,D=2;D<e.length;D++){var _=JSON.parse(e[D]);switch(_.action){case"move":var I=v(_,a,i,t,m,T,g,R,P),z=Object(o.a)(I,2),W=z[0],F=z[1];g=W,c=c.concat(F),T=[];break;case"startTurn":C=1===n?A%2+1:(A+1)%2+1,A++,P.push({text:Object(s.jsxs)("span",{children:["Start ",Object(s.jsx)(f,{text:"turn "+A,project:C}),Object(s.jsx)(d,{text:" ("+_.timeLeft.toFixed(2)+"s left)"})]}),time:g}),g=N(a,i,C,g,w,P),w=[];break;case"endTurn":break;case"overwatch":var B=a;i.project===_.project&&(B=i),g+=50;var L,M=Object(r.a)(B.units);try{for(M.s();!(L=M.n()).done;){var U=L.value;if(U.name===_.unit)j(U,{time:g,overwatch:!0,actions:U.events[U.events.length-1].actions-2})}}catch(ue){M.e(ue)}finally{M.f()}P.push({text:Object(s.jsxs)("span",{children:[Object(s.jsx)(f,{text:_.unit,project:_.project})," is overwatching"]}),time:g});break;case"reload":var G=x(_,a,i,g,P),J=Object(o.a)(G,2),K=J[0],Y=J[1];g=K,p.push(Y);break;case"obstacleShot":if(_.hit){P.push({text:Object(s.jsxs)("span",{children:[Object(s.jsx)(f,{text:_.unit,project:_.project})," hits an obstacle at ["+_.targetLocation[0]+", "+_.targetLocation+"]",Object(s.jsx)(d,{text:" (hit: "+_.hitRoll+" / "+_.hitChance+")"})]}),time:g});var H,X=Object(r.a)(E);try{for(X.s();!(H=X.n()).done;){g=S(H.value,m,g,a,i,R,P)}}catch(ue){X.e(ue)}finally{X.f()}E=[]}else P.push({text:Object(s.jsxs)("span",{children:[Object(s.jsx)(f,{text:_.unit,project:_.project})," misses an obstacle at ["+_.targetLocation[0]+", "+_.targetLocation+"]",Object(s.jsx)(d,{text:" (hit: "+_.hitRoll+" / "+_.hitChance+")"})]}),time:g});break;case"obstacleUpdate":E.push(_);break;case"enemy":R.push(_);break;case"item":if("grenade"===_.item){var q=O(_,a,i,w,g,R,P),V=Object(o.a)(q,3),$=V[0],Q=V[1],Z=V[2];g=$,u.push(Q),w=[];var ee,te=Object(r.a)(E);try{for(te.s();!(ee=te.n()).done;){S(ee.value,m,Z,a,i,R,P)}}catch(ue){te.e(ue)}finally{te.f()}E=[]}else if("medikit"===_.item){var ne=y(_,a,i,w,g,P),ae=Object(o.a)(ne,2),oe=ae[0],re=ae[1];g=oe,h.push(re),w=[]}else console.log("unknown item: '"+_.item+"' from action: '"+_.action+"'");break;case"damage":"grenade"===_.item||"medikit"===_.item?w.push(_):console.log("unknown damage: "+_.item);break;case"shot":if(null!=_.overwatch&&_.overwatch)T.push(_);else{var se=b(_,a,i,0,g,P),ie=Object(o.a)(se,2),le=ie[0],ce=ie[1];g=le,c=c.concat(ce)}break;default:console.log("unknown action: '"+_.action+"'")}}return[a,i,c,u,h,p,m,g,P]},w=n(133),E=n(13),R=Object(i.lazy)((function(){return Promise.all([n.e(191),n.e(232)]).then(n.bind(null,468))}));function P(e){var t,n=e.detailedOutput,a=e.keyRef,o=[],i=0,l=Object(r.a)(n);try{for(l.s();!(t=l.n()).done;){var c=t.value;i++;var u=c.startsWith("ERR:"),f=c.slice(4);o.push(Object(s.jsx)("div",{className:u?"results-debug-error":"results-debug-normal",children:f},"detailedOutput-"+a+"-"+i))}}catch(d){l.e(d)}finally{l.f()}return o}function A(e){var t=e.mutation,n=Object(i.useState)(null),a=Object(o.a)(n,2),l=a[0],c=a[1],d=Object(i.useState)(0),h=Object(o.a)(d,2),p=h[0],j=h[1];t.setUnitToDisplay=c;var m=function(e){if(null!=l.events&&l.events.length>0){var t=p;for(l.events.length-1<t&&(t=l.events.length-1);l.events.length>t+1&&l.events[t+1].time<=e;)t++;for(;l.events[t].time>e&&0<t;)t--;t!==p&&j(t)}};Object(i.useEffect)((function(){if(null!=l)return m(t.clock),t.setTimeForUnitPanel=function(e){null!=l&&m(e)},function(){t.setTimeForUnitPanel=function(){}}}),[l]);var v=[],g=null;if(null!=l&&null!=l.events&&l.events.length>p&&(g=l.events[p]),null!=l&&null!=g){var b="",O=0;if(null!=g.items&&g.items.length>0){var y,x=Object(r.a)(g.items);try{for(x.s();!(y=x.n()).done;){var S=y.value;O>0&&(b+=", "),b+=S,O++}}catch(N){x.e(N)}finally{x.f()}}""===b&&(b="-");var k=function(e){var t="";return e.moving&&(""!==t&&(t+=", "),t+="moving"),e.dashing&&(""!==t&&(t+=", "),t+="dashing"),e.peeking&&(""!==t&&(t+=", "),t+="peeking"),e.shooting&&(""!==t&&(t+=", "),t+="shooting"),e.reloading&&(""!==t&&(t+=", "),t+="reloading"),e.healing&&(""!==t&&(t+=", "),t+="healing"),e.throwing&&(""!==t&&(t+=", "),t+="throwing"),e.damaged&&(""!==t&&(t+=", "),t+="damaged"),e.overwatch&&(""!==t&&(t+=", "),t+="overwatching"),e.dead&&(""!==t&&(t+=", "),t+="incapacitated"),""===t&&(t="-"),t}(g);v.push(Object(s.jsxs)("div",{className:"results-unit-panel",children:[Object(s.jsxs)("div",{className:"results-unit-details-name",children:[Object(s.jsx)("button",{className:"results-unit-details-close-button",title:"Close panel",onClick:function(e){c(null),e.preventDefault()},children:Object(s.jsx)(u.a,{icon:"times"})}),Object(s.jsx)(u.a,{icon:g.visible?"eye":"eye-slash",title:g.visible?"Unit is visible to the enemy":"Unit is invisible to the enemy"})," ",Object(s.jsx)(f,{text:l.name,project:l.project})]}),Object(s.jsx)("table",{className:"results-unit-details-table",children:Object(s.jsxs)("tbody",{children:[Object(s.jsxs)("tr",{className:"results-unit-details-table-tr",children:[Object(s.jsx)("th",{className:"results-unit-details-table-th",children:"Type:"}),Object(s.jsx)("td",{className:"results-unit-details-table-td",children:l.type})]}),Object(s.jsxs)("tr",{className:"results-unit-details-table-tr",children:[Object(s.jsx)("th",{className:"results-unit-details-table-th",children:"Location:"}),Object(s.jsxs)("td",{className:"results-unit-details-table-td",children:[g.location.x,", ",g.location.z]})]}),Object(s.jsxs)("tr",{className:"results-unit-details-table-tr",children:[Object(s.jsx)("th",{className:"results-unit-details-table-th",children:"Actions:"}),Object(s.jsxs)("td",{className:"results-unit-details-table-td",children:[g.actions," / 2"]})]}),Object(s.jsxs)("tr",{className:"results-unit-details-table-tr",children:[Object(s.jsx)("th",{className:"results-unit-details-table-th",children:"Movement:"}),Object(s.jsx)("td",{className:"results-unit-details-table-td",children:l.movement})]}),Object(s.jsxs)("tr",{className:"results-unit-details-table-tr",children:[Object(s.jsx)("th",{className:"results-unit-details-table-th",children:"Vision:"}),Object(s.jsx)("td",{className:"results-unit-details-table-td",children:l.vision})]}),Object(s.jsxs)("tr",{className:"results-unit-details-table-tr",children:[Object(s.jsx)("th",{className:"results-unit-details-table-th",children:"Health:"}),Object(s.jsxs)("td",{className:"results-unit-details-table-td",children:[g.health," / ",l.maxHealth]})]}),Object(s.jsxs)("tr",{className:"results-unit-details-table-tr",children:[Object(s.jsx)("th",{className:"results-unit-details-table-th",children:"Armor Bonus:"}),Object(s.jsx)("td",{className:"results-unit-details-table-td",children:g.armorBonus>0?g.armorBonus:"-"})]}),Object(s.jsxs)("tr",{className:"results-unit-details-table-tr",children:[Object(s.jsx)("th",{className:"results-unit-details-table-th",children:"Armor:"}),Object(s.jsx)("td",{className:"results-unit-details-table-td",children:""!==l.armor?l.armor:"-"})]}),Object(s.jsxs)("tr",{className:"results-unit-details-table-tr",children:[Object(s.jsx)("th",{className:"results-unit-details-table-th",children:"Weapon:"}),Object(s.jsx)("td",{className:"results-unit-details-table-td",children:""!==l.weapon?l.weapon:"-"})]}),Object(s.jsxs)("tr",{className:"results-unit-details-table-tr",children:[Object(s.jsx)("th",{className:"results-unit-details-table-th",children:"Weapon Mags:"}),Object(s.jsx)("td",{className:"results-unit-details-table-td",children:g.weaponMags>0?g.weaponMags:"-"})]}),Object(s.jsxs)("tr",{className:"results-unit-details-table-tr",children:[Object(s.jsx)("th",{className:"results-unit-details-table-th",children:"Ammo:"}),Object(s.jsx)("td",{className:"results-unit-details-table-td",children:l.maxAmmo>0?g.ammo+" / "+l.maxAmmo:"-"})]}),Object(s.jsxs)("tr",{className:"results-unit-details-table-tr",children:[Object(s.jsx)("th",{className:"results-unit-details-table-th",children:"Items:"}),Object(s.jsx)("td",{className:"results-unit-details-table-td",children:b})]}),Object(s.jsxs)("tr",{className:"results-unit-details-table-tr",children:[Object(s.jsx)("th",{className:"results-unit-details-table-th",children:"Enemy Name:"}),Object(s.jsx)("td",{className:"results-unit-details-table-td",children:null!=g.enemyName?g.enemyName:"-"})]}),Object(s.jsxs)("tr",{className:"results-unit-details-table-tr",children:[Object(s.jsx)("th",{className:"results-unit-details-table-th",children:"Status:"}),Object(s.jsx)("td",{className:"results-unit-details-table-td",children:k})]})]})})]},"unit-display-panel-"+l.project+"-"+l.name))}return v}function C(e){var t=e.log,n=e.mutation,a=Object(i.useRef)(),r=Object(i.useState)(0),l=Object(o.a)(r,2),c=l[0],u=l[1];n.setTimeForLog=function(e){if(!(null==t||t.length<=0)){for(var n=c;e<t[n].time&&n>0;)n--;for(;t.length>n+1&&e>=t[n+1].time;)n++;c!==n&&u(n)}};for(var f=[],d=0;d<=c;d++){var h=t[d];f.push(Object(s.jsxs)("div",{className:"results-event-log-line",children:[Object(s.jsx)("span",{className:"results-dimmed-colour",children:"["+D(h.time/1e3)+"] "}),h.text]},"event-log-"+d))}return f.push(Object(s.jsx)("div",{ref:a},"event-log scroller")),Object(i.useEffect)((function(){null!=a.current&&a.current.scrollIntoView({behavior:"smooth"})})),f}function D(e){var t=Math.trunc(e/60),n=Math.trunc(e)%60;return t.toString().padStart(2,"0")+":"+n.toString().padStart(2,"0")}function _(e){var t=e.isDebugOutput,n=e.css,a=e.second,o=e.showDebug,l=e.setShowDebug,c=e.setShowDebugOthers,f=e.keyRef,d=e.icon,h=e.title;Object(i.useEffect)((function(){o?document.documentElement.style.setProperty(n,"inline"):document.documentElement.style.setProperty(n,"none")}),[o]);var p=[];if(t){var j="results-playbutton results-playbutton-pressed";a&&(j="results-playbutton results-playbutton-pressed2"),p.push(Object(s.jsx)("button",{className:o?j:"results-playbutton",title:h,onClick:function(e){if(l(!o),!o){var t,n=Object(r.a)(c);try{for(n.s();!(t=n.n()).done;){(0,t.value)(!1)}}catch(a){n.e(a)}finally{n.f()}}e.preventDefault()},children:Object(s.jsx)(u.a,{icon:d})},f))}return p}function I(e){var t=e.mutation,n=e.isDebugOutput,a=e.isDebugOutput2,r=Object(i.useState)(!1),l=Object(o.a)(r,2),c=l[0],f=l[1],d=Object(i.useState)(),h=Object(o.a)(d,2)[1],p=Object(i.useState)(0),j=Object(o.a)(p,2),m=j[0],v=j[1],g=Object(i.useState)(!0),b=Object(o.a)(g,2),O=b[0],y=b[1],x=Object(i.useState)(!1),S=Object(o.a)(x,2),k=S[0],N=S[1],T=Object(i.useState)(!1),w=Object(o.a)(T,2),E=w[0],R=w[1];t.stopPlaying=function(){f(!1),t.playing=!1},t.startPlaying=function(){f(!0),t.playing=!0},t.setTime=function(){var e=Math.trunc(t.clock/1e3);m!==e&&v(e)};var P=c?"pause":"play";t.maxClock===t.clock&&(P="undo-alt");var A=Object(i.useRef)(),C=D(t.maxClock/1e3),I=D(m);return Object(s.jsxs)("div",{className:"results-playback",children:[Object(s.jsx)("div",{ref:A,className:"results-progressbar",onClick:function(e){var n=A.current.offsetWidth;if(0!==n&&void 0!==n){var a=e.nativeEvent.offsetX,o=a/n*t.maxClock,r=a/n*100;t.clock=o,t.setProgressBarPercentage(r),h(r)}},onMouseMove:function(e){if(!(null==e.buttons||e.buttons<=0)){var n=A.current.offsetWidth;if(0!==n&&void 0!==n){var a=e.nativeEvent.offsetX,o=a/n*t.maxClock,r=a/n*100;t.clock=o,t.setProgressBarPercentage(r),h(r)}}},children:Object(s.jsx)("span",{className:"results-progressbar-filler"})}),Object(s.jsx)("button",{className:"results-playbutton",title:"Play results",onClick:function(e){e.preventDefault(),t.clock===t.maxClock&&(t.clock=0),t.playing=!c,f(!c)},children:Object(s.jsx)(u.a,{icon:P})}),Object(s.jsx)(_,{keyRef:"eventLogButton",isDebugOutput:!0,css:"--results-event-log-overlay-display",second:!1,showDebug:O,setShowDebug:y,setShowDebugOthers:[N,R],icon:"list",title:"Show combat log"}),Object(s.jsx)(_,{keyRef:"debugOutputButton1",isDebugOutput:n,css:"--results-debug-overlay-display",second:!1,showDebug:k,setShowDebug:N,setShowDebugOthers:[R,y],icon:"bug",title:"Show debug output"}),Object(s.jsx)(_,{keyRef:"debugOutputButton2",isDebugOutput:a,css:"--results-debug-overlay-display2",second:!0,showDebug:E,setShowDebug:R,setShowDebugOthers:[N,y],icon:"bug",title:"Show debug output"}),Object(s.jsxs)("span",{className:"results-playbutton",children:[I," / ",C]})]})}t.default=function(e){var t=Object(E.d)(),n=Object(o.a)(t,1)[0],r=n.get("ap"),u=n.get("au"),f=n.get("dp"),d=n.get("du"),h=n.get("test");Object(i.useEffect)((function(){document.title=null!=r?h?e.title.replace("{0}",r+" vs Idle Test"):e.title.replace("{0}",r+" vs "+f):e.title.replace("{0}","unknown project")}),[e.title,r,f,h]);var p=Object(i.useState)(null),j=Object(o.a)(p,2),m=j[0],v=j[1],g=Object(i.useState)(null),b=Object(o.a)(g,2),O=b[0],y=b[1],x=Object(i.useState)(!1),S=Object(o.a)(x,2),k=S[0],N=S[1],D=Object(i.useState)(null),_=Object(o.a)(D,2),z=_[0],W=_[1],F=Object(i.useState)(null),B=Object(o.a)(F,2),L=B[0],M=B[1],U=Object(i.useState)({playing:!1,clock:0,maxClock:2e3,lastUpdate:null,stopPlaying:function(){J.playing=!1},startPlaying:function(){J.playing=!0},setTime:function(){},setTimeForLog:function(){},setProgressBarPercentage:function(e){return document.documentElement.style.setProperty("--results-progressbar-width",e+"%")}}),G=Object(o.a)(U,2),J=G[0],K=G[1],Y=function(e){if(" "===e.key)e.preventDefault(),J.playing?J.stopPlaying():J.startPlaying();else if(","===e.key){e.preventDefault();var t=J.clock-100;t<0&&(t=0),t!==J.clock&&(J.clock=t)}else if("."===e.key){e.preventDefault();var n=J.clock+100;n>J.maxClock&&(n=J.maxClock),n!==J.clock&&(J.clock=n)}};if(Object(i.useEffect)((function(){return document.addEventListener("keydown",Y),function(){return document.removeEventListener("keydown",Y)}})),Object(i.useEffect)((function(){var e=function(e){if(!e.success)return y(e.reason),void N(e.success);v(e.project);var t=e.project;if(null!=t.output&&t.output.length>1&&null!=t.heightMap){var n=T(t.output,t.heightMap,t.firstTurn),a=Object(o.a)(n,9),r=a[0],s=a[1],i=a[2],l=a[3],c=a[4],u=a[5],f=a[6],d=a[7],h=a[8];M({units1:r,units2:s,shots:i,heightMapTimes:f,tosses:l,heals:c,reloads:u}),W(h),K({playing:!1,clock:0,maxClock:d,lastUpdate:null,stopPlaying:function(){J.playing=!1},startPlaying:function(){J.playing=!0},setTime:function(){},setTimeForLog:function(){},setTimeForUnitPanel:function(){},setProgressBarPercentage:function(e){return document.documentElement.style.setProperty("--results-progressbar-width",e+"%")},setUnitToDisplay:function(){}}),J.setProgressBarPercentage(0)}N(e.success)},t=!1;if(l.a.isLoggedIn())if(h)c.a.getIdleTestResults(r,e),t=!0;else{var n=l.a.getUsername();n===u&&n===d?(c.a.getAttackerAndDefenderResults(r,f,e),t=!0):n===u?(c.a.getAttackerResults(r,d,f,e),t=!0):n===d&&(c.a.getDefenderResults(f,u,r,e),t=!0)}t||(w.a.getBrawl(u,r,d,f,e),t=!0)}),[r,f,u,d,h]),k&&null!=m){var H=[],X=[];null!=m.detailedOutput&&m.detailedOutput.length>0&&(H=m.detailedOutput),null!=m.detailedOutput2&&m.detailedOutput2.length>0&&(X=m.detailedOutput2);var q=[0,1.5,0],V=1,$=1;null!=m.heightMap&&m.heightMap.length>0&&(V=m.heightMap[0].length,$=m.heightMap.length,q[0]=V/2,q[2]=$/2);var Q="Idle Test",Z="";return null!=f&&(Q=f,Z=Object(s.jsxs)("div",{children:["Authors: ",Object(s.jsxs)("span",{className:"results-attacker-colour",title:m.country,children:[Object(s.jsx)("span",{className:"flag-icon flag-icon-"+m.countryCode.toLowerCase()+" ranking-flag-size"}),u]})," vs ",Object(s.jsxs)("span",{className:"results-defender-colour",title:m.opponentCountry,children:[Object(s.jsx)("span",{className:"flag-icon flag-icon-"+m.opponentCountryCode.toLowerCase()+" ranking-flag-size"}),d]})]})),Object(s.jsxs)("div",{className:"results-page",children:[Object(s.jsxs)("div",{className:"results-header",children:[Object(s.jsxs)("h2",{className:"results-header-h2",children:[Object(s.jsx)("span",{className:"results-attacker-colour",children:r})," vs ",Object(s.jsx)("span",{className:"results-defender-colour",children:Q})]}),Z]}),Object(s.jsx)(i.Suspense,{fallback:Object(s.jsx)("div",{children:"Loading..."}),children:Object(s.jsx)(R,Object(a.a)(Object(a.a)({},L),{},{heightMap:m.heightMap,mutation:J,target:q}))}),Object(s.jsx)(I,{mutation:J,isDebugOutput:H.length>0,isDebugOutput2:X.length>0}),Object(s.jsx)("div",{className:"results-debug-overlay",children:Object(s.jsx)(P,{detailedOutput:H,keyRef:1})}),Object(s.jsx)("div",{className:"results-debug-overlay2",children:Object(s.jsx)(P,{detailedOutput:X,keyRef:2})}),Object(s.jsx)("div",{className:"results-event-log-overlay",children:Object(s.jsx)(C,{mutation:J,log:z})}),Object(s.jsx)("div",{children:Object(s.jsx)(A,{mutation:J})})]})}return null!==O?Object(s.jsxs)("div",{className:"info-page",children:[Object(s.jsx)("p",{children:"Failed to get any progress information."}),null!=O?Object(s.jsxs)("p",{children:["Error: ",O]}):""]}):Object(s.jsx)("div",{className:"info-page",children:Object(s.jsx)("p",{children:"Loading..."})})}},77:function(e,t,n){"use strict";function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}n.d(t,"a",(function(){return a}))},79:function(e,t,n){"use strict";var a=n(63),o=n(11),r=n(12),s=n(62),i=n(7),l=function(){function e(){Object(o.a)(this,e)}return Object(r.a)(e,null,[{key:"defaultFiles",value:function(){return[{name:"New Folder",open:!0,data:[{name:"Hello World.py",data:"# This is example code!\n\nimport json\n\nmessage = json.loads(input())\n\nheight_map = message['heightMap']\n#print(\"map:\", height_map)\n\nunits = message['units']\nprint(\"Got the following units:\")\nfor unit in units:\n    print(unit)\nprint(\"cost of units:\", message['cost']) # Total cost of the squad\n\nmessage = json.loads(input())\nif message['action'] == 'startTurn':\n    print(f\"First turn has started! Got {message['timeLeft']} seconds left and the time is ticking.\")\n\nprint(\"Hello world!\")\n\nprint(\"Lets finish this turn!\")\nprint(json.dumps({\n    'action': 'endTurn'\n}))\n",start:!0}]}]}},{key:"renameProject",value:function(t,n,a){var o=i.c.warning("Renaming "+t+"...",{autoClose:!1});s.a.fetchSecurePOST("rename_project",{oldName:t,newName:n},(function(r){e.finishToast(r,o,"Failed to rename "," renamed to "+n+".",t,a)}),(function(a){e.finishToast(a,o,"Failed to rename "," renamed to "+n+".",t,void 0)}))}},{key:"loadFiles",value:function(t,n){e.postWithToast("get_project_files",t,"Loading files for ","Failed to load files for "," files loaded.",n)}},{key:"loadUnits",value:function(t,n){e.postWithToast("get_project_units",t,"Loading units for ","Failed to load units for "," units loaded.",n)}},{key:"deleteProject",value:function(t,n){e.postWithToast("delete_project",t,"Deleting ","Failed to delete "," deleted.",n)}},{key:"launchProject",value:function(t,n){e.postWithToast("launch_project",t,"Launching ","Failed to launch "," launched.",n)}},{key:"listProjects",value:function(t){e.get("list_projects",t)}},{key:"createProject",value:function(t,n){e.postWithToast("create_project",t,"Creating ","Failed to create "," created.",n)}},{key:"getProgress",value:function(t,n){e.postWithToast("get_project_progress",t,"Loading ","Failed to load "," loaded.",n)}},{key:"getIdleTestResults",value:function(t,n){e.postWithToast("get_project_idle_test",t,"Loading ","Failed to load "," loaded.",n)}},{key:"getDefenderResults",value:function(t,n,a,o){e.postWithToastPayload("get_project_defense",t,{projectName:t,opponentUsername:n,opponentProjectName:a},"Loading ","Failed to load "," loaded.",o)}},{key:"getAttackerResults",value:function(t,n,a,o){e.postWithToastPayload("get_project_attack",t,{projectName:t,opponentUsername:n,opponentProjectName:a},"Loading ","Failed to load "," loaded.",o)}},{key:"getAttackerAndDefenderResults",value:function(t,n,a){e.postWithToastPayload("get_project_attack_and_defense",t,{projectName1:t,projectName2:n},"Loading ","Failed to load "," loaded.",a)}},{key:"post",value:function(e,t,n){s.a.fetchSecurePOST(e,{name:t},(function(e){n&&n(e)}),(function(t){console.log("POST ERROR: "+e),console.log(t),void 0!==t&&null!==t&&t.toString().length<100&&i.c.error(t.toString(),{autoClose:1e4})}))}},{key:"get",value:function(e,t){s.a.fetchSecureGET(e,(function(e){t&&t(e)}),(function(t){console.log("GET ERROR: "+e),console.log(t),void 0!==t&&null!==t&&t.toString().length<100&&i.c.error(t.toString(),{autoClose:1e4})}))}},{key:"duplicateProject",value:function(t,n,a){var o=i.c.warning("Duplicating "+t+"...",{autoClose:!1});s.a.fetchSecurePOST("duplicate_project",{name:t,duplicateName:n},(function(n){e.finishToast(n,o,"Failed to duplicate "," duplicated.",t,a)}),(function(n){e.finishToast(n,o,"Failed to duplicate "," duplicated.",t,void 0)}))}},{key:"postWithToast",value:function(t,n,a,o,r,l){var c=i.c.warning(a+n+"...",{autoClose:!1});s.a.fetchSecurePOST(t,{name:n},(function(t){e.finishToast(t,c,o,r,n,l(t))}),(function(t){e.finishToast(t,c,o,r,n,void 0)}))}},{key:"postWithToastPayload",value:function(t,n,a,o,r,l,c){var u=i.c.warning(o+n+"...",{autoClose:!1});s.a.fetchSecurePOST(t,a,(function(t){e.finishToast(t,u,r,l,n,c(t))}),(function(t){e.finishToast(t,u,r,l,n,void 0)}))}},{key:"saveFiles",value:function(t,n,a){var o=i.c.warning("Saving "+t+"...",{autoClose:!1});s.a.fetchSecurePOST("save_project_files",{name:t,files:JSON.stringify(n)},(function(n){e.finishToast(n,o,"Failed to save "," saved.",t,a)}),(function(n){e.finishToast(n,o,"Failed to save "," saved.",t,void 0)}))}},{key:"saveUnits",value:function(t,n,a){var o=i.c.warning("Saving "+t+"...",{autoClose:!1});s.a.fetchSecurePOST("save_project_units",{name:t,units:JSON.stringify(n)},(function(n){e.finishToast(n,o,"Failed to save "," saved.",t,a)}),(function(n){e.finishToast(n,o,"Failed to save "," saved.",t,void 0)}))}},{key:"finishToast",value:function(e,t,n,o,r){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0;if(void 0!==e)if(void 0!==e.success)if(e.success)i.c.update(t,{render:r+o,type:i.c.TYPE.SUCCESS,autoClose:500}),void 0!==s&&s();else if(void 0!==e.reason)if("field"===e.reason){var l,c="",u=Object(a.a)(e.field);try{for(u.s();!(l=u.n()).done;){var f=l.value;c.length>0&&(c+=" "),c+=f.reason}}catch(d){u.e(d)}finally{u.f()}i.c.update(t,{render:n+r+": "+c,type:i.c.TYPE.ERROR,autoClose:1e4})}else i.c.update(t,{render:n+r+": "+e.reason,type:i.c.TYPE.ERROR,autoClose:1e4});else i.c.update(t,{render:n+r+".",type:i.c.TYPE.ERROR,autoClose:1e4});else void 0!==e.reason?i.c.update(t,{render:n+r+": "+e.reason,type:i.c.TYPE.ERROR,autoClose:1e4}):(i.c.update(t,{render:n+r+": "+e,type:i.c.TYPE.ERROR,autoClose:1e4}),console.log(e));else i.c.update(t,{render:n+r+".",type:i.c.TYPE.ERROR,autoClose:1e4}),console.log("results is undefined!")}},{key:"timeSince",value:function(e){if(null===e||void 0===e||""===e)return"not yet";var t=Math.floor((Date.now()-Date.parse(e))/1e3),n=Math.floor(t/31536e3);return n>=1?n+(1===n?" year":" years"):(n=Math.floor(t/2592e3))>=1?n+(1===n?" month":" months"):(n=Math.floor(t/86400))>=1?n+(1===n?" day":" days"):(n=Math.floor(t/3600))>=1?n+(1===n?" hour":" hours"):(n=Math.floor(t/60))>=1?n+(1===n?" minute":" minutes"):Math.floor(t)+(1===n?" second":" seconds")}}]),e}();t.a=l},95:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(106);var o=n(70),r=n(107);function s(e,t){return Object(a.a)(e)||function(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var n=[],a=!0,o=!1,r=void 0;try{for(var s,i=e[Symbol.iterator]();!(a=(s=i.next()).done)&&(n.push(s.value),!t||n.length!==t);a=!0);}catch(l){o=!0,r=l}finally{try{a||null==i.return||i.return()}finally{if(o)throw r}}return n}}(e,t)||Object(o.a)(e,t)||Object(r.a)()}}}]);