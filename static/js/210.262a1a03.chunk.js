(this.webpackJsonppages=this.webpackJsonppages||[]).push([[210],{37:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(58);function o(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=Object(r.a)(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var o=0,s=function(){};return{s:s,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}},505:function(e,t,n){"use strict";n.r(t);var r=n(9),o=n(10),s=n(11),i=n(12),a=n(37),c=n(0),u=n.n(c),l=n(61),h=n(2),d=n(14),f=n(1);function p(e){var t,n=e.fields,r=e.targetField,o=[],s=Object(a.a)(n);try{for(s.s();!(t=s.n()).done;){var i=t.value;i.field===r&&o.push(Object(f.jsx)("div",{className:"alert alert-danger small-error",role:"alert",children:i.reason},r+i.reason))}}catch(c){s.e(c)}finally{s.f()}return o}function g(e){var t=e.message,n=[];return void 0!==t&&null!==t&&n.push(Object(f.jsx)("div",{className:"alert alert-danger small-error",role:"alert",children:t},"messageAlert")),n}var m=function(e){Object(s.a)(n,e);var t=Object(i.a)(n);function n(e){var o;return Object(r.a)(this,n),(o=t.call(this,e)).handleUsername=function(e){o.setState({username:e.target.value})},o.handlePassword=function(e){o.setState({password:e.target.value})},o.handleEmail=function(e){o.setState({email:e.target.value})},o.handleAgree=function(e){o.setState({agree:e.target.checked})},o.handleSubmit=function(e){e.preventDefault();var t=o.state,n=t.username,r=t.password,s=t.email,i=t.agree;l.a.register(n,r,s,i,o.handleRegistrationSuccess,o.handleRegistrationError),(o.state.logout||o.state.register)&&o.setState({logout:!1,register:!1})},o.handleRegistrationSuccess=function(e){void 0!==e.success&&(e.success?o.setState({success:!0}):void 0!==e.reason&&("field"===e.reason?o.setState({errors:e.field,errorMessage:""}):o.setState({errors:[],errorMessage:e.reason})))},o.handleRegistrationError=function(e){console.log("onError"),console.log(e)},o.state={username:"",password:"",email:"",agree:!1,errors:[],errorMessage:null,success:!1},o}return Object(o.a)(n,[{key:"componentDidMount",value:function(){void 0!==this.props.title&&(document.title=this.props.title)}},{key:"render",value:function(){var e=this.state,t=e.username,n=e.password,r=e.errors,o=e.errorMessage,s=e.email,i=e.agree;return e.success?Object(f.jsx)(h.a,{to:"/login?registered"}):Object(f.jsx)("div",{className:"form-container",children:Object(f.jsx)("div",{className:"form-box",children:Object(f.jsxs)("div",{className:"form-presentation",children:[Object(f.jsx)("h2",{className:"form-title",children:"Create a new account"}),Object(f.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(f.jsxs)("div",{className:"form-group",children:[Object(f.jsx)(p,{fields:r,targetField:"username"}),Object(f.jsx)("input",{type:"text",className:"form-control",id:"username",placeholder:"Enter username",autoComplete:"off",onChange:this.handleUsername,value:t,required:!0,autoFocus:!0})]}),Object(f.jsxs)("div",{className:"form-group",children:[Object(f.jsx)(p,{fields:r,targetField:"password"}),Object(f.jsx)("input",{type:"password",className:"form-control",id:"password",placeholder:"Enter password",autoComplete:"off",onChange:this.handlePassword,value:n,required:!0})]}),Object(f.jsxs)("div",{className:"form-group",children:[Object(f.jsx)(p,{fields:r,targetField:"email"}),Object(f.jsx)("input",{type:"email",className:"form-control",id:"email","aria-describedby":"emailHelp small-error",placeholder:"Enter email (optional)",onChange:this.handleEmail,value:s,autoComplete:"off"})]}),Object(f.jsxs)("div",{className:"form-text-area",children:[Object(f.jsx)("p",{children:"There are a few rules:"}),Object(f.jsxs)("ul",{children:[Object(f.jsx)("li",{children:"Username must be between 2 and 32 characters. Must be formed of latin alphabets (a-z and A-Z) and arabic numbers (0-9). It may also contain hyphens and underscores, but not consecutively and cannot start or end with one."}),Object(f.jsx)("li",{children:"Password must be between 8 and 1024 characters. Most of UTF-8 works."}),Object(f.jsxs)("li",{children:["Email is optional. It is only used for recovering accounts with forgotten credentials. Note: email address is ",Object(f.jsx)(d.c,{to:"/privacy",className:"inline",children:"case-sensitive"}),"."]}),Object(f.jsxs)("li",{children:["Everything that you submit (code, data and otherwise, except email and password) you give us the right to license/relicense with ",Object(f.jsx)("a",{className:"inline",href:"https://www.gnu.org/licenses/gpl-3.0.en.html",children:"GPL v3"})," or later. For example: your code will be published under GPL v3 or later and associated with your username."]}),Object(f.jsx)("li",{children:"You will remain responsible for everything that you submit to us, including its legality and appropriateness."}),Object(f.jsx)("li",{children:"If your account is inactive for a long period of time (for example 90 days) it may be deleted."}),Object(f.jsxs)("li",{children:["For the rest of the terms see:  ",Object(f.jsx)(d.c,{to:"/terms",className:"inline",children:"brawl.ai/terms"}),"."]})]})]}),Object(f.jsxs)("div",{className:"form-group",children:[Object(f.jsx)("input",{type:"checkbox",id:"agree",className:"form-checkbox",onChange:this.handleAgree,checked:i}),Object(f.jsx)("label",{htmlFor:"agree",children:"I agree to the rules."}),Object(f.jsx)(p,{fields:r,targetField:"agree"}),Object(f.jsx)(g,{message:o})]}),Object(f.jsx)("div",{className:"form-button-padding",children:Object(f.jsx)("button",{type:"submit",className:"active-button form-button-primary",children:"Create User"})})]})]})})})}}]),n}(u.a.Component);t.default=m},58:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(67);function o(e,t){if(e){if("string"===typeof e)return Object(r.a)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(r.a)(e,t):void 0}}},61:function(e,t,n){"use strict";var r=n(9),o=n(10),s=function(){function e(){Object(r.a)(this,e)}return Object(o.a)(e,null,[{key:"loginUrl",value:function(e,t){fetch(this.ADDRESS+"/login/").then((function(e){return e.json()})).then((function(t){e(t)}),(function(e){t(e)}))}},{key:"authorize",value:function(e,t,n){var r=this;return fetch(this.ADDRESS+"/login/authorize",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({code:e})}).then((function(e){return e.json()})).then((function(e){r.parseJWT(e),t()}),(function(e){n(e)})),!0}},{key:"changePassword",value:function(e,t,n,r){return fetch(this.ADDRESS+"/login/change_password",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({username:this.getUsername(),oldPassword:e,newPassword:t})}).then((function(e){return e.json()})).then((function(e){n(e)}),(function(e){r(e)})),!0}},{key:"requestPasswordResetCode",value:function(e,t,n){return fetch(this.ADDRESS+"/login/reset_password_request",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({email:e})}).then((function(e){return e.json()})).then((function(e){t(e)}),(function(e){n(e)})),!0}},{key:"usePasswordResetCode",value:function(e,t,n,r){return fetch(this.ADDRESS+"/login/reset_password",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({code:e,password:t})}).then((function(e){return e.json()})).then((function(e){n(e)}),(function(e){r(e)})),!0}},{key:"requestAddEmail",value:function(e,t,n,r){return fetch(this.ADDRESS+"/login/add_email",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({username:this.getUsername(),email:e,password:t})}).then((function(e){return e.json()})).then((function(e){n(e)}),(function(e){r(e)})),!0}},{key:"requestEmailRemovalCode",value:function(t,n,r){return fetch(this.ADDRESS+"/login/remove_email_request",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({username:this.getUsername(),password:t})}).then((function(e){return e.json()})).then((function(t){null!=t.success&&t.success&&(e.emailDeletionWarning=!0,e.updateWarning()),n(t)}),(function(e){r(e)})),!0}},{key:"removeEmailWithoutCode",value:function(t,n,r){return fetch(this.ADDRESS+"/login/remove_email_without_code",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({username:this.getUsername(),password:t})}).then((function(e){return e.json()})).then((function(t){null!=t.success&&t.success&&(e.emailDeletionWarning=!1,e.updateWarning()),n(t)}),(function(e){r(e)})),!0}},{key:"removeEmailWithCode",value:function(t,n,r){return fetch(this.ADDRESS+"/login/remove_email_with_code",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({code:t})}).then((function(e){return e.json()})).then((function(t){null!=t.success&&t.success&&e.getRegisteredEmail((function(){}),(function(){})),n(t)}),(function(e){r(e)})),!0}},{key:"getRegisteredEmail",value:function(t,n){var r=this,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=sessionStorage.getItem(this.ACCESS_TOKEN);return void 0===s||this.isAccessTokenExpired()?o?(this.refresh((function(){r.getRegisteredEmail(t,n,o=!1)}),n),!0):(n("Not logged in."),!1):(fetch(this.ADDRESS+"/login/get_email",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({token:s})}).then((function(e){if(401!==e.status||!o)return e.json();r.refresh((function(){r.getRegisteredEmail(t,n,o=!1)}),n)})).then((function(n){e.emailDeletionWarning=null!=n.emailExpiry,e.updateWarning(),t(n)}),(function(e){n(e)})),!0)}},{key:"authenticate",value:function(e,t,n,r){var o=this;return fetch(this.ADDRESS+"/login/authenticate",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({username:e,password:t})}).then((function(e){return e.json()})).then((function(e){o.parseJWT(e),n(e)}),(function(e){r(e)})),!0}},{key:"register",value:function(e,t,n,r,o,s){var i=JSON.stringify({username:e,password:t,email:n,agree:r});return(null===n||void 0===n||n.length<1)&&(i=JSON.stringify({username:e,password:t,agree:r})),fetch(this.ADDRESS+"/login/register",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:i}).then((function(e){return e.json()})).then((function(e){o(e)}),(function(e){s(e)})),!0}},{key:"updateLoginButton",value:function(){e.loginButton&&e.loginButton.updateLoginState()}},{key:"updateWarning",value:function(){null!=e.loginButton&&e.loginButton.updateWarning()}},{key:"refresh",value:function(t,n){var r=this,o=localStorage.getItem(this.REFRESH_TOKEN);return void 0===o?(n("Not logged in."),!1):(fetch(this.ADDRESS+"/login/refresh",{headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST",body:JSON.stringify({token:o})}).then((function(e){return e.json()})).then((function(o){void 0!==o.success?o.success?r.parseJWT(o)?t():n("Didn't undertand the response from the server."):(e.logout(),void 0!==o.reason?n(o.reason):n("Unsuccessful refresh of access token.")):n("Unknown error on refreshing access token.")}),(function(e){n(e)})),!0)}},{key:"fetchSecureGET",value:function(e,t,n){var r=this,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=sessionStorage.getItem(this.ACCESS_TOKEN);return void 0===s||this.isAccessTokenExpired()?o?(this.refresh((function(){r.fetchSecureGET(e,t,n,o=!1)}),n),!0):(n("Not logged in."),!1):(fetch(this.ADDRESS+"/secure/"+e,{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+s},method:"GET"}).then((function(s){401===s.status&&o?r.refresh((function(){r.fetchSecureGET(e,t,n,o=!1)}),n):s.json().then((function(e){t(e)}),(function(e){n(e)}))})),!0)}},{key:"fetchSecurePOST",value:function(e,t,n,r){var o=this,s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=sessionStorage.getItem(this.ACCESS_TOKEN);return void 0===i?s?(this.refresh((function(){o.fetchSecurePOST(e,n,r,s=!1)}),r),!0):(r("Not logged in."),!1):(fetch(this.ADDRESS+"/secure/"+e,{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+i},method:"POST",body:JSON.stringify(t)}).then((function(i){401===i.status&&s?o.refresh((function(){o.fetchSecurePOST(e,t,n,r,s=!1)}),r):i.json().then((function(e){n(e)}),(function(e){r(e)}))})),!0)}},{key:"getUsername",value:function(){return localStorage.getItem(this.USERNAME)}},{key:"logout",value:function(){sessionStorage.removeItem(this.ACCESS_TOKEN),sessionStorage.removeItem(this.ACCESS_TOKEN_EXPIRY),localStorage.removeItem(this.REFRESH_TOKEN),localStorage.removeItem(this.REFRESH_TOKEN_EXPIRY),localStorage.removeItem(this.USERNAME),this.updateLoginButton()}},{key:"isLoggedIn",value:function(){var t=void 0!==this.getUsername()&&null!==this.getUsername();return t&&e.isRefreshTokenExpired()&&(e.logout(),t=!1),t}},{key:"parseJWT",value:function(e){if(void 0===e.access_token)return this.logout(),!1;sessionStorage.setItem(this.ACCESS_TOKEN,e.access_token),localStorage.setItem(this.REFRESH_TOKEN,e.refresh_token);var t=e.access_token.split(".");if(null!==t&&3===t.length){var n=atob(t[1]);n=JSON.parse(n),sessionStorage.setItem(this.ACCESS_TOKEN_EXPIRY,n.exp)}localStorage.setItem(this.USERNAME,e.username);var r=JSON.parse(atob(e.refresh_token.split(".")[1]));return localStorage.setItem(this.REFRESH_TOKEN_EXPIRY,r.exp),this.updateLoginButton(),!0}},{key:"isAccessTokenExpired",value:function(){var e=sessionStorage.getItem(this.ACCESS_TOKEN_EXPIRY);return void 0===e||null===e||new Date(1e3*parseInt(e))-new Date<0}},{key:"isRefreshTokenExpired",value:function(){var e=localStorage.getItem(this.REFRESH_TOKEN_EXPIRY);return void 0===e||null===e||new Date(1e3*parseInt(e))-new Date<0}},{key:"ACCESS_TOKEN",get:function(){return"access_token"}},{key:"ACCESS_TOKEN_EXPIRY",get:function(){return"access_token_expiry"}},{key:"REFRESH_TOKEN",get:function(){return"refresh_token"}},{key:"REFRESH_TOKEN_EXPIRY",get:function(){return"refresh_token_expiry"}},{key:"USERNAME",get:function(){return"username"}},{key:"ADDRESS",get:function(){return"https://api.brawl.ai"}}]),e}();s.emailDeletionWarning=!1,s.loginButton=null,t.a=s},67:function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,"a",(function(){return r}))}}]);